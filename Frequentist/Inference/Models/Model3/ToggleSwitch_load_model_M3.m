function [model] = ToggleSwitch_load_model_M3()

% This script contains the main model structure that we propose for the Toggle Switch
% Amongst the models being considered for model selection, this is Model
% M3.

% model.AMIGOjac = 0;                                                         % Compute Jacobian 0 = No, 1 = yes
model.input_model_type='charmodelC';                                        % Model introduction: 'charmodelC'|'c_model'|'charmodelM'|'matlabmodel'|'sbmlmodel'|'blackboxmodel'|'blackboxcost                             
model.n_st=4;                                                               % Number of states      
model.n_par=14;                                                             % Number of model parameters 
model.n_stimulus=2;                                                         % Number of inputs, stimuli or control variables   
model.stimulus_names=char('u_IPTG','u_aTc');                                % Name of stimuli or control variables
model.st_names=char('IPTGi','aTci','L_RFP','T_GFP');      % Names of the states                                              
model.par_names=char('k_iptg',...
                     'k_aTc',...
                     'kL_p_m0','kL_p_m','theta_T','theta_aTc','n_aTc','n_T',...
                     'kT_p_m0','kT_p_m','theta_L','theta_IPTG','n_IPTG','n_L');  % Names of the parameters    
                 
model.eqns=...                                                              % Equations describing system dynamics. Time derivatives are regarded 'd'st_name''
               char('dIPTGi = k_iptg*(u_IPTG-IPTGi)-0.0165*IPTGi',...
                    'daTci = k_aTc*(u_aTc-aTci)-0.0165*aTci',...
                    'dL_RFP = 1/0.1386*(kL_p_m0 + (kL_p_m/(1+(T_GFP/theta_T*(1/(1+(aTci/theta_aTc)^n_aTc)))^n_T)))-0.0165*L_RFP',...
                    'dT_GFP = 1/0.1386*(kT_p_m0 + (kT_p_m/(1+(L_RFP/theta_L*(1/(1+(IPTGi/theta_IPTG)^n_IPTG)))^n_L)))-0.0165*T_GFP');
                    

%==================
% PARAMETER VALUES
% =================
% Mean from Bayesian posterior distributions
% model.par=[0.443732205394829,...
%            0.013349915462226,...
%            0.059800778853462, 6.328318273925677, 91.802515203012447, 0.917790244270208, 0.442365215362061, 3.268297044061151,...
%            0.274994347269609, 4.481803576253988, 2.689954614178675, 0.017202415361504, 0.807729114638047, 0.713161785811728];
       
% % Mean from PE in AMIGO llk       
% model.par=[0.448799999929274,...
%            0.018748559382442,...
%            0.336599999997435, 6.801492394476686, 37.326287188175861, 0.891300000115423, 0.633876414261242, 3.248283135006099,...
%            0.174595800291914, 11.220199999712056, 22.250873435444777, 0.008900000015343, 0.227500953289925, 2.30173328534470];
       
% Mean from PE in AMIGO lsq       
model.par=[0.017486759440755,...
           0.011592929618346,...
           0.336522517740871, 5.705484507418318, 19.109506443534496, 0.891542128534452, 1.303415881241293, 3.596924951202656,...
           0.355447150563472, 2.150070441863721, 148.8064428320237, 0.242578510569612, 5.123217357025394, 5.123646005360894];
       
% % Mean from PE in AMIGO lsq (No cross-validation)    
% model.par=[0.003600029166033,...
%            0.008900018322197,...
%            0.336599878343289, 5.593007599067646, 35.165476396868229, 0.891301072243163, 1.169332789858367, 5.124999238704657,...
%            0.425362660523555, 11.220192191531256, 42.952347300414019, 1.121981633305583, 1.431274463209857, 1.491518040903746];       
%        


% % Mean from PE in AMIGO lsq with bistability without the inducers      
% model.par=[0.184018543619413,...
%            0.008900010844513,...
%            0.002700459754770, 6.642648517051732, 96.868678980172135, 0.891300449089410, 0.570847182449541, 2.319116529246030,...
%            0.246112107618602, 2.018182546376508, 108.4356103732518, 0.185381811931108, 5.124999055205570, 5.124994356712212];




end                                 