function [model] = ToggleSwitch_load_model_M1vsM3_ModelSelection()

% This script contains the model structures 1 (Lugagne) and 3 (ours) for the Toggle Switch
% toghether for OED purposes. 

% model.AMIGOjac = 0;                                                         % Compute Jacobian 0 = No, 1 = yes
model.input_model_type='charmodelC';                                        % Model introduction: 'charmodelC'|'c_model'|'charmodelM'|'matlabmodel'|'sbmlmodel'|'blackboxmodel'|'blackboxcost                             
model.n_st=8;                                                               % Number of states      
model.n_par=30;                                                             % Number of model parameters 
model.n_stimulus=2;                                                         % Number of inputs, stimuli or control variables   
model.stimulus_names=char('u_IPTG','u_aTc');                                % Name of stimuli or control variables
model.st_names=char('IPTGi', 'aTci', 'L_RFP', 'T_GFP',...
                    'IPTGi2','aTci2','L_RFP2','T_GFP2');      % Names of the states    
                
model.par_names=char('k_in_IPTG','k_out_IPTG',...
                     'k_in_aTc','k_out_aTc',...
                     'kL_p_m0', 'kL_p_m', 'theta_T', 'theta_aTc', 'n_aTc', 'n_T',...
                     'kT_p_m0', 'kT_p_m', 'theta_L', 'theta_IPTG','n_IPTG','n_L',...
                     ...
                     'k_iptg2',...
                     'k_aTc2',...
                     'kL_p_m02','kL_p_m2','theta_T2','theta_aTc2', 'n_aTc2', 'n_T2',...
                     'kT_p_m02','kT_p_m2','theta_L2','theta_IPTG2','n_IPTG2','n_L2');                                  % Names of the parameters    
                 
model.eqns=...                                                              % Equations describing system dynamics. Time derivatives are regarded 'd'st_name''
               char('dIPTGi = (k_in_IPTG*(u_IPTG-IPTGi)+((k_in_IPTG*(u_IPTG-IPTGi))^2)^0.5)/2-(k_out_IPTG*(IPTGi-u_IPTG)+((k_out_IPTG*(IPTGi-u_IPTG))^2)^0.5)/2',...
                    'daTci = (k_in_aTc*(u_aTc-aTci)+((k_in_aTc*(u_aTc-aTci))^2)^0.5)/2-(k_out_aTc*(aTci-u_aTc)+((k_out_aTc*(aTci-u_aTc))^2)^0.5)/2',...
                    'dL_RFP = 1/0.1386*(kL_p_m0 + (kL_p_m/(1+(T_GFP/theta_T*(1/(1+(aTci/theta_aTc)^n_aTc)))^n_T)))-0.0165*L_RFP',...
                    'dT_GFP = 1/0.1386*(kT_p_m0 + (kT_p_m/(1+(L_RFP/theta_L*(1/(1+(IPTGi/theta_IPTG)^n_IPTG)))^n_L)))-0.0165*T_GFP',...
                    ...
                    'dIPTGi2 = k_iptg2*(u_IPTG-IPTGi2)-0.0165*IPTGi2',...
                    'daTci2 = k_aTc2*(u_aTc-aTci2)-0.0165*aTci2',...
                    'dL_RFP2 = 1/0.1386*(kL_p_m02 + (kL_p_m2/(1+(T_GFP2/theta_T2*(1/(1+(aTci2/theta_aTc2)^n_aTc2)))^n_T2)))-0.0165*L_RFP2',...
                    'dT_GFP2 = 1/0.1386*(kT_p_m02 + (kT_p_m2/(1+(L_RFP2/theta_L2*(1/(1+(IPTGi2/theta_IPTG2)^n_IPTG2)))^n_L2)))-0.0165*T_GFP2');
                    

%==================
% PARAMETER VALUES
% =================

% model.par=[0.020111389897527, 0.128282663077499,...
%            0.050860069020588, 0.010925654275698,...
%            0.062805254607594, 6.868917319754384, 12.187591525604125, 0.955268146228872, 0.871912929733276, 2.515646174794705,...
%            0.112919021105846, 4.463535789998920, 3.411190626599335, 0.034258442259940, 1.111815029253142, 0.608548883387730,...
%            ...
%            0.443732205394829,...
%            0.013349915462226,...
%            0.059800778853462, 6.328318273925677, 91.802515203012447, 0.917790244270208, 0.442365215362061, 3.268297044061151,...
%            0.274994347269609, 4.481803576253988, 2.689954614178675, 0.017202415361504, 0.807729114638047, 0.713161785811728];


% % Mean from PE in AMIGO llk
% model.par=[0.017330874028137, 0.448799612352708,...
%            0.039114902187151, 0.008900001708622,...
%            0.091140279001490, 6.587465246253584, 17.254439365949061, 0.891319610677261, 0.913056682378459, 2.969688404397886,...
%            0.343908271720810, 1.948644862100263, 192.5106670890757, 0.216070722048464, 5.124980226781978, 5.124987871692474,...
%            ...
%            0.017486759440755,...
%            0.011592929618346,...
%            0.336522517740871, 5.705484507418318, 19.109506443534496, 0.891542128534452, 1.303415881241293, 3.596924951202656,...
%            0.355447150563472, 2.150070441863721, 148.8064428320237, 0.242578510569612, 5.123217357025394, 5.123646005360894];
    
% Mean from PE in AMIGO lsq
model.par=[0.017330874028137, 0.448799612352708,...
           0.039114902187151, 0.008900001708622,...
           0.091140279001490, 6.587465246253584, 17.254439365949061, 0.891319610677261, 0.913056682378459, 2.969688404397886,...
           0.343908271720810, 1.948644862100263, 192.5106670890757, 0.216070722048464, 5.124980226781978, 5.124987871692474,...
           ...
           0.017486759440755,...
           0.011592929618346,...
           0.336522517740871, 5.705484507418318, 19.109506443534496, 0.891542128534452, 1.303415881241293, 3.596924951202656,...
           0.355447150563472, 2.150070441863721, 148.8064428320237, 0.242578510569612, 5.123217357025394, 5.123646005360894];
end               

        